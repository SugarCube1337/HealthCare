<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Candidates</title>
</head>
<body>
<h1>Candidates for Vacancy</h1>
<ul>
  <li th:each="candidate : ${candidates}">
    <p><strong>Name:</strong> <span th:text="${candidate.name}"></span></p>
    <p><strong>Email:</strong> <span th:text="${candidate.email}"></span></p>
    <p><strong>Status:</strong> <span th:text="${candidate.status}"></span></p>
    <button onclick="updateStatus(${candidate.id}, 'Accepted')">Accept</button>
    <button onclick="updateStatus(${candidate.id}, 'Rejected')">Reject</button>
  </li>
</ul>

<script>
  function updateStatus(candidateId, status) {
    fetch(`/vacancies/candidates/${candidateId}/status`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ status })
    }).then(response => {
      if (response.ok) {
        alert("Status updated successfully!");
        location.reload();
      } else {
        alert("Failed to update status.");
      }
    });
  }

  function updateStatus(candidateId, status) {
    const action = status === 'Accepted' ? 'accept' : 'reject';
    fetch(`/vacancies/${vacancyId}/candidates/${candidateId}/${action}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
    }).then(response => {
      if (response.ok) {
        alert("Status updated successfully!");
        location.reload();
      } else {
        alert("Failed to update status.");
      }
    });
  }

</script>
</body>
</html>
